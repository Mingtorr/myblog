+++
author = "Mincheol Park"
date = "2020-09-07"
description = "React + node.js + multer"
title = "이미지 업로드 하는 방법"
categories = ["react"]
tags=["React","multer-s3","node.js","mysql"]
draft = true
+++

웹에서 사진을 받아 저장하는 방법은 다음과 같습니다.

1. base64로 인코딩하여 DB에 저장

base64로 인코딩할 경우 1만 byte의 사진만으로도 1만자의 문자열이 나옵니다. varchar2를 사용할 수 없는 mysql에서는 base64 문자열을 db에 직접 저장하는 방식은 효율적인 방법이 아닙니다. 또한 base64에는 체크섬이나 저장을 위한 어떠한 값도 저장하지 않으며 이진 형식보다 데이터의 양을 늘립니다.

2. 데이터베이스에 사진 파일 직접 저장

이미지 blob 데이터를 바이너리를 통해 직접 저장할 수 있습니다. 하지만 overhead 때문에 file 을 DB에 직접 저장하는 경우 보다는 경로만 저장하는 경우가 더 많습니다. 프로필 이미지 같은 경우에는 변경이 적으니 직접 저장해도 되지만, 게시글 속의 사진의 경우 사진태그를 추출해 bolb 데이터로 변환시키고 저장하는 방식은 성능면에서 비합리적인 것처럼 보입니다.

3. 사진 파일은 로컬 스토리지에 저장한 뒤 사진의 이름만 DB에 저장

4. AWS S3에 사진파일 저장한 후 링크로 불러 사진 출력
