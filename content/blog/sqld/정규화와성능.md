+++
author = "Mincheol Park"
categories = ["Blog"]
tags = ["Markdown"]
date = 2020-09-09T19:49:28+09:00
description = "정규화를 통한 성능 향상 전략"
title = "정규화와 성능"
+++

# 정규화

> 관계형 데이터베이스 설계에서 중복을 최소하하게 데이터를 구조화 하는 프로세스  
> **데이터를 결정하는 결정자에 의해 함수적 종속성을 가지고 있는 일반 속성을 의존자로 하여 입력, 수정, 삭제 이상을 제거하는 것이다.**

정규화가 중복을 제거하고 관심사별로 처리되는 경우가 많아 **입력,수정,삭제기능**의 성능이 향상되는 특성이 있다.  
하지만 엔터티가 계속 발생되어 SQL 문장에서 조인이 많이 발생하여 이로 인한 **조회** 기능에서의 성능저하가 나타나는 경우도 있다.  
데이터의 중복속성을 제거하고 결정자에 의해 동일한 의미의 일반속성이 하나의 테이블로 집약되므로 한 테이블의 용량은 최소화되지만 이를 조회하기 위해서는 조인을 사용해야 한다. 따라서 이런 부분은 적절히 반정규화를 해주어야 한다.

<br>
<br>

<p align="center"><img src="/img/blog/SQL_074.jpg"></p>
<br>

> 정규화가 잘 되어 있으면 입력, 수정, 삭제의 성능이 좋아지고 반정규화를 많이 하면 조회성능이 뛰어나다고 생각해서는 안된다. 실제 사례에서 정규화를 해야 조회성능이 향상되는 경우가 아주 많다.

<br>
<br>

# 반정규화된 테이블의 성능저하 사례

<p align="center"><img src="/img/blog/SQL_075.jpg"></p>
<br>

왼쪽은 정규화가 이루이지지 않은 테이블이고 오른쪽은 2차 정규화가 이루어진 테이블이다. 정규화가 이루어지지 않은 상태에서는 한번에 조회가 가능하지만, 정규화가 이루어진 상태에서는 조인을 사용해야 한다. 하지만 아래 코드처럼 PK가 걸려 있는 방향으로 조인을 걸면 UK(Unique Index)를 곧바로 찾아 조회하기 때문에 속도차이가 많이 나지 않는다.

#

```slq
SELECT 직급명, B.관서번호, B.관서명
FROM 정부보관금관서원장 A, 관서 B
WHERE 직급코드 = 'AA'
AND A.관서번호=B.관서번호;

```

#

또한 위의 예제에서 2010년 이후 관서를 모두 조회하라는 조건이 추가되면 정규화된 테이블이 훨씬 빠르다. 왼쪽에서는 불필요하게 납부자번호만큼 누적된 데이터를 읽어서 결과를 구분하여 보여주지만 오른쪽에서는 관서수만큼만 존재하는 데이터를 읽어 곧바로 결과를 보여주기 때문이다. 이처럼 단순한 예만 살펴보아도 정규화를 수행하면 무조건 조회성능이 떨어지는 것이 아니다.

<br>
<br>

# 함수적 종속성(Functional Dependency)에 근거한 정규화 수행 필요

함수의 종속성(Functional Dependency)은 데이터들이 어떤 기준값에 의해 종속되는 현상을 지칭하는 것이다. 이 때 기준값을 결정자(Determinant)라 하고 종속되는 값을 종속자(Dependent)라고 한다. 사람이라는 엔터티는 주민등록번호, 이름, 출생지, 호주라는 속성이 존재할 수 있다. 여기서 이름, 출생지, 호주는 주민등록번호 속성에 종속된다. 이를 기호로 표시하게 되면 주민등록번호 -> (이름, 출생지, 호주) 라고 표현할 수 있다. 이 때 주민등록번호가 이름, 출생지, 호주를 함수적으로 결정한다라고 말할 수 있다.

<p align="center"><img src="/img/blog/SQL_087.jpg"></p>
<br>
함수의 종속성은 데이터가 가지고 있는 근본적인 속성으로 인식되고 있는데, 이와 같이 함수의 종속성을 가지는 모델링은 정규화가 필수적이다. 정규화의 궁극적인 목적이 반복적인 데이터를 분리하고 각 데이터가 종속된 테이블에 적절하게 배치되도록 하는 것이므로 이 함수의 종속성을 이용하여 정규화 작업이나 각 오브젝트에 속성을 배치하는 작업에 이용이 되는 것이다.

기본적으로 데이터는 속성간의 함수종속성에 근거하여 정규화되어야 한다. 정규화는 프로젝트에서 필수사항이며, IT프로젝트를 진행하는 설계자는 정규화의 이론을 반드시 숙지하고 데이터 모델링을 해야 한다.

<br>

출처: SQL 전문가 가이드 - KDB 한국데이터베이스진흥원
